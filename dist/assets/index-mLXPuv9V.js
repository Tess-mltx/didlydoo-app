(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&c(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const m=document.getElementById("addDateBtn");m.addEventListener("click",h);function h(){const t=document.getElementById("datesInputs"),e=document.createElement("input");e.classList.add("form_date"),e.setAttribute("type","date"),t.append(e)}const f=document.querySelector("#submitEvent"),y=document.getElementById("nameEvent"),E=document.getElementById("author"),v=document.getElementById("datesInputs"),g=document.querySelector("#desc");let s=[];f.addEventListener("click",()=>{v.querySelectorAll('input[type="date"]').forEach(e=>{let n=e.value;s.push(n)}),console.log(s),b()});async function b(){const t=y.value,e=s,n=E.value,c=g.value;await fetch("http://localhost:3000/api/events/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,dates:e,author:n,description:c})}),l()}async function l(){try{const e=await(await fetch("http://localhost:3000/api/events")).json();return console.log(e),e}catch(t){console.error("Erreur de récupération des données :",t)}}l();function u(t){return t.parentNode.id.split("-")[1]}async function L(t){try{const n=await(await fetch(`http://localhost:3000/api/events/${t}`)).json();return console.log(n),n}catch(e){console.error("Erreur de récupération du single event :",e)}}function C(){console.log("Setting up edit fct"),document.querySelectorAll(".btnEdit").forEach(e=>{e.addEventListener("click",async function(){let n=await u(e);S(n)})})}async function S(t){console.log("Setting up edit btn; id : ",t);let e=await L(t);await w(e),document.querySelector(".editEventForm-btnSubmit").addEventListener("click",async function(){I(t)})}async function w(t){let e=document.querySelector(`#card-${t.id}`),n=document.createElement("form");n.classList.add("editEventForm"),e.appendChild(n);let c=document.createElement("input");c.classList.add("editEventForm-title"),c.value=t.name,c.setAttribute("required",!0),n.appendChild(c);let o=document.createElement("input");o.classList.add("editEventForm-author"),o.setAttribute("required",!0),o.value=t.author,n.appendChild(o);let r=document.createElement("textarea");r.classList.add("editEventForm-description"),r.setAttribute("required",!0),r.setAttribute("maxlenght","256"),r.value=t.description,n.appendChild(r);let a=document.createElement("button");a.setAttribute("type","button"),a.classList.add("editEventForm-btnSubmit"),a.appendChild(document.createTextNode("Editer")),n.appendChild(a)}async function I(t){const e=document.querySelector(".editEventForm-title").value,n=document.querySelector(".editEventForm-author").value,c=document.querySelector(".editEventForm-description").value;try{await fetch(`http://localhost:3000/api/events/${t}/`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,author:n,description:c})})}catch{}}function q(){console.log("Setting up delete fct"),document.querySelectorAll(".btnDelete").forEach(e=>{e.addEventListener("click",async function(){let n=await u(e);console.log("Setting up delete btn; id : ",n),A(n)})})}async function A(t){try{await fetch(`http://localhost:3000/api/events/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})}catch(e){console.error("Erreur de récupération des données :",e)}location.reload()}const p=document.querySelector("main");async function D(){p.innerHTML="";try{(await l()).forEach(e=>{B(e)}),C(),q()}catch(t){console.error("Erreur lors de la récupération des événements",t)}}D();function B(t){const e=document.createElement("div");e.classList.add("event-card"),e.id=`card-${t.id}`;const n=document.createElement("h3");n.textContent=t.name;const c=document.createElement("p");c.textContent=t.description;const o=document.createElement("p");o.textContent=`Auteur: ${t.author}`;const r=document.createElement("button");r.textContent="Participer",r.classList.add("participate-button"),r.addEventListener("click",()=>{location.href=`/event.html?id=${t.id}`});const a=document.createElement("button");a.classList.add("btnDelete"),a.textContent="Supprimer";const i=document.createElement("button");i.classList.add("btnEdit"),i.textContent="Éditer",e.appendChild(a),e.appendChild(i),e.appendChild(n),e.appendChild(c),e.appendChild(o),e.appendChild(r),p.appendChild(e)}function T(){return"hsl("+Math.floor(Math.random()*360)+", 100%, 92%)"}const F=document.getElementById("toggleDarkMode");let d;function N(t){d||(d=setInterval(P,500,t))}function P(t){t.forEach(e=>{let n=T();e.style.backgroundColor=n,e.style.color="hsl(230, 40%, 10%)"})}F.addEventListener("change",function(){let t=document.documentElement,e=document.querySelector(".bodyPage");document.querySelector(".mainPage");let n=document.querySelectorAll(".event-card");switch(this.checked){case!0:t.classList.add("partyMode"),e.classList.add("partyMode","bodyPage"),N(n);break;case!1:t.classList.remove("partyMode"),e.classList.remove("partyMode"),x();break}});function x(){clearInterval(d),d=null}
